#------------------------------------------------------------------------------
# FILE LOCATIONS
#------------------------------------------------------------------------------
#data_directory = 'ConfigDir'                  # Use data in another directory (requires restart)
#hba_file = 'ConfigDir/pg_hba.conf'            # Host-based authentication file (requires restart)
#ident_file = 'ConfigDir/pg_ident.conf'        # Ident configuration file (requires restart)

#------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#------------------------------------------------------------------------------
listen_addresses = '*'                         # Listen on all IP addresses (requires restart)
port = 5432                                    # Default port (requires restart)
unix_socket_directories = '/tmp'
max_connections = 200                          # Increase as needed (requires restart)
# More on connection settings: https://www.postgresql.org/docs/current/runtime-config-connection.html

#------------------------------------------------------------------------------
# WRITE-AHEAD LOG (WAL)
#------------------------------------------------------------------------------
wal_level = replica                            # Necessary for backups and high availability
archive_mode = on                              # Enable WAL archiving
archive_command = 'pgbackrest --stanza=main-db archive-push %p'
# pgBackRest documentation: https://pgbackrest.org/user-guide.html

#------------------------------------------------------------------------------
# WAL SETTINGS FOR PERFORMANCE AND RELIABILITY
#------------------------------------------------------------------------------
min_wal_size = 1GB                             # Minimum WAL size
max_wal_size = 4GB                             # Maximum WAL size
checkpoint_timeout = 10min                     # Time between automatic WAL checkpoints
checkpoint_completion_target = 0.7             # Checkpoint target duration, 0.0 - 1.0
# WAL configuration: https://www.postgresql.org/docs/current/runtime-config-wal.html

#------------------------------------------------------------------------------
# REPLICATION SETTINGS
#------------------------------------------------------------------------------
#max_wal_senders = 10                          # Max number of WAL sender processes (requires restart)
#max_replication_slots = 10                    # Max number of replication slots (requires restart)
# Replication configuration: https://www.postgresql.org/docs/current/runtime-config-replication.html

#------------------------------------------------------------------------------
# MEMORY USAGE
#------------------------------------------------------------------------------
shared_buffers = 4GB                           # Increase based on your server's memory (requires restart)
work_mem = 16MB                                # Amount of memory for query operations
maintenance_work_mem = 1GB                     # Memory for maintenance tasks like VACUUM
# Memory configuration tips: https://www.postgresql.org/docs/current/runtime-config-resource.html

#------------------------------------------------------------------------------
# LOGGING
#------------------------------------------------------------------------------
log_destination = 'stderr'                     # Log to stderr (consider syslog for production)
logging_collector = on                         # Enable capturing of stderr and csvlog into log files
log_directory = 'log'                          # Directory where log files are written
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'# Log file name pattern
log_truncate_on_rotation = on                  # Truncate existing log file on rotation
log_rotation_age = 1d                          # Rotate logs after one day
log_rotation_size = 10MB                       # Rotate logs after 10MB
log_min_messages = warning                     # Set the minimum message levels to log
log_min_error_statement = error                # Log all queries that generate an error
# Logging best practices: https://www.postgresql.org/docs/current/runtime-config-logging.html

#------------------------------------------------------------------------------
# STATISTICS
#------------------------------------------------------------------------------
track_activities = on                          # Track activity for connections
track_counts = on                              # Track counts for database activity
# More on statistics monitoring: https://www.postgresql.org/docs/current/monitoring-stats.html

#------------------------------------------------------------------------------
# VACUUMING SETTINGS
#------------------------------------------------------------------------------
autovacuum = on                                # Enable autovacuum subprocesses
autovacuum_max_workers = 3                     # Max number of autovacuum subprocesses (requires restart)
autovacuum_naptime = 1min                      # Time between autovacuum runs
autovacuum_vacuum_scale_factor = 0.2           # Fraction of table size before vacuum
# Autovacuum configuration: https://www.postgresql.org/docs/current/runtime-config-autovacuum.html

#------------------------------------------------------------------------------
# CLIENT CONNECTION DEFAULTS
#------------------------------------------------------------------------------
#datestyle = 'iso, mdy'                        # Set date style
#timezone = 'UTC'                              # Set timezone
# More on client connection defaults: https://www.postgresql.org/docs/current/runtime-config-client.html

#------------------------------------------------------------------------------
# CUSTOMIZED OPTIONS
#------------------------------------------------------------------------------
# Add settings for extensions and other custom configurations here

# Further documentation and complete list of parameters:
# PostgreSQL official documentation: https://www.postgresql.org/docs/current/runtime-config.html
